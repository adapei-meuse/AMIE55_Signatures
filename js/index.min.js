const RELEASE="2.1.8";console.log("Signatures v "+RELEASE);document.getElementById("appRelease").innerText=RELEASE;const ITEMS=["name","surname","orgTitle","organisation","email","domain","phone","mobile","pole"],SEPARATOR_COLORS={ADAPEI:"#e6b000",DIOCESE:"#0b4a6d",IDEASLAB:"#1E4E5F"},DEFAULT_IMG_PATH="img/logos/",POLES_ARRAY=[adapei={lib:"Adapei de la Meuse",color:SEPARATOR_COLORS.ADAPEI,src:"adapei.png"},retroActif={lib:"Les rétro actifs",color:SEPARATOR_COLORS.ADAPEI,src:"retroActif.png"},meuseInsertion={lib:"Meuse Insertion",color:SEPARATOR_COLORS.ADAPEI,src:"meuseInsertion.png"},adultesDependants={lib:"Pôle Adultes Dépendants",color:SEPARATOR_COLORS.ADAPEI,src:"adultesDependants.png"},agricole={lib:"Pôle Agricole",color:SEPARATOR_COLORS.ADAPEI,src:"agricole.png"},enfance={lib:"Pôle Enfance",color:SEPARATOR_COLORS.ADAPEI,src:"enfance.png"},habitat={lib:"Pôle Habitat",color:SEPARATOR_COLORS.ADAPEI,src:"habitat.png"},industriel={lib:"Pôle Industriel",color:SEPARATOR_COLORS.ADAPEI,src:"industriel.png"},mobiMeuse={lib:"Mobi'Meuse",color:SEPARATOR_COLORS.ADAPEI,src:"mobimeuse.png"},abri={lib:"Abri des Pèlerins",color:SEPARATOR_COLORS.ADAPEI,src:"abri.png"},pairactifs={lib:"Pairs'Actifs",color:SEPARATOR_COLORS.ADAPEI,src:"pairsactifs.png"},diocese={lib:"Diocèse",color:SEPARATOR_COLORS.DIOCESE,src:"diocese.png",hidden:!0,domaine:"@catholique55.fr"},mda={lib:"Maison des Adolescents",color:SEPARATOR_COLORS.ADAPEI,src:"mda.jpg",hidden:!0,domaine:"@mda55.fr"},ideaslab={lib:"Ideas Lab",color:SEPARATOR_COLORS.IDEASLAB,src:"ideaslab.png",hidden:!0,domaine:"@ideas-lab.tech"},handicoeur={lib:"Handi Coeur",color:SEPARATOR_COLORS.ADAPEI,src:"handicoeur.jpg",hidden:!0,domaine:"@caph-handicoeur.fr"},amie55={lib:"amie55",color:SEPARATOR_COLORS.ADAPEI,src:"amie55.jpg",hidden:!0,domaine:"@amie55.com"}],poleInput=document.getElementById("poleInput"),checkMobileInput=document.getElementById("checkMobileInput"),checkPhoneInput=document.getElementById("checkPhoneInput");document.getElementById("inputForm").addEventListener("submit",e=>e.preventDefault()),POLES_ARRAY.forEach((e,t)=>{let o=addOptionToSelect(poleInput,t,e.lib);e.hidden&&hideOption(o)}),ITEMS.forEach(e=>{let t=e+"Input",o=e+"Output";document.getElementById(t).addEventListener("change",e=>displayInputToOutput(e.target,document.getElementById(o)))}),checkMobileInput.addEventListener("change",function(){displayNone(document.getElementById("liMobile")),updateImageOutput()}),checkPhoneInput.addEventListener("change",function(){displayNone(document.getElementById("liPhone")),updateImageOutput()});function displayNone(e){"d-none"===e.getAttribute("class")?e.setAttribute("class","d-flex align-items-center"):e.setAttribute("class","d-none")}function displayInputToOutput(e,t){if(!e.value)return;"nameOutput"===t.id||"surnameOutput"===t.id?(t.innerText=e.value,champEmail=document.getElementById("emailInput"),champEmail.value=prenomNomToEmail(document.getElementById("nameInput").value,document.getElementById("surnameInput").value),champEmail.dispatchEvent(new Event("change"))):"IMG"===t.nodeName?(t.src=DEFAULT_IMG_PATH+POLES_ARRAY[e.value].src,t.crossOrigin="anonymous",setSeparatorBorderColor(document.getElementById("separator"),POLES_ARRAY[e.value].color)):"domainInput"===e.id?(t.innerText=e.value.toLowerCase(),selectPoleFromDomaine(e)):t.innerText=e.value,updateImageOutput()}function updateImageOutput(){window.scrollTo(0,0),html2canvas(document.getElementById("outputCard"),{scale:.85}).then(function(e){lien=e.toDataURL("image/jpeg"),lienSignature=document.getElementById("lienSignature"),document.getElementById("signatureOutput").src=lien,lienSignature.href=lien,lienSignature.download=document.getElementById("nameInput").value+"_"+document.getElementById("surnameInput").value+".jpg"})}function setSeparatorBorderColor(e,t){e.style.borderColor=t}function selectPoleFromDomaine(e){POLES_ARRAY.forEach((t,o)=>{e.value===t.domaine&&selectValue(poleInput,o)})}function addOptionToSelect(e,t,o){let n=document.createElement("option");return n.appendChild(document.createTextNode(o)),n.value=t,e.appendChild(n),n}function hideOption(e){e.hidden=!0}function selectValue(e,t){e.value=t,e.dispatchEvent(new Event("change"))}function prenomNomToEmail(e,t){return e.toLowerCase()[0]+"."+t.toLowerCase()}
